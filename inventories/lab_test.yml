all:
  hosts:
  vars:
    lab_name: lab_test
    lab_prefix: "{{ lab_name }}_"
    lab_password: P@ssw0rd
    lab_vm_datastore: "{{ lab_name }}"
    lab_wan_portgroup: "{{ vm_network }}"
    lab_lan1_portgroup: "{{ lab_prefix }}net1"
    lab_lan1_netmask_cidr: "24"
    lab_lan1_netmask: "255.255.255.0"
    lab_lan1_gateway: "192.168.0.1"
    lab_lan1_dns_ip: "192.168.0.11"
    lab_lan2_portgroup: "{{ lab_prefix }}net2"
    lab_domain_name: "lab.local"
    lab_dc01_hostname: "dc01"
    lab_dc01_ip: "192.168.0.11"
  children:
    pfsense:
      hosts:
        gateway:
          state: force
          #ip_address: 192.168.0.1
          vm_network_wan: "{{lab_wan_portgroup}}"
          vm_network_lan: "{{lab_lan1_portgroup}}"
          config_xml_file: "files/pfsense/config.xml"

    dc:
      hosts:
        dc01:
          version: "Server2022eval"
          ip_address: 192.168.0.11
          extra_files_urls:
            - https://dl.google.com/chrome/install/googlechromestandaloneenterprise64.msi
            - http://the.earth.li/~sgtatham/putty/0.83/w64/putty-64bit-0.83-installer.msi
          # extra_files:
          #   - "{{ playbook_dir }}/files/googlechromestandaloneenterprise64.msi"
          #   - "{{ playbook_dir }}/files/putty-64bit-0.83-installer.msi"
          extra_commands:
            # Install Chrome from CDrom on E:\
            - MsiExec.exe /i E:\files\googlechromestandaloneenterprise64.msi /qn
            # Install Putty
            - "MsiExec.exe /i E:\\files\\putty-64bit-0.83-installer.msi /qn"

    winservers:
      hosts:
        server2025:
          ip_address: 192.168.0.25
          version: "Server2025eval"
          vm_disk_gb: 80
        server2022:
          ip_address: 192.168.0.22
          version: "Server2022eval"
        server2019:
          ip_address: 192.168.0.12
          version: "Server2019eval"
        server2016:
          ip_address: 192.168.0.23
          version: "Server2016eval"
        server2012R2:
          ip_address: 192.168.0.26
          version: "Server2012R2eval"
        server2008R2:
          ip_address: 192.168.0.27
          version: "Server2008R2eval"
        windows10:
          ip_address: 192.168.0.27
          version: "Windows10eval"
      vars:
          vm_memory_mb: 4096
          vm_num_cpus: 2
          vm_disk_gb: 40
          join_domain: true
          extra_files_urls:
            - https://dl.google.com/chrome/install/googlechromestandaloneenterprise64.msi
            - http://the.earth.li/~sgtatham/putty/0.83/w64/putty-64bit-0.83-installer.msi
          extra_commands:
            - "MsiExec.exe /i E:\\files\\putty-64bit-0.83-installer.msi /qn"
            - "MsiExec.exe /i E:\\files\\googlechromestandaloneenterprise64.msi /qn"

    ovf:
      vars:
        ovf_file: files/isilon/9.1.0.0/9.1.0.0.ova
        ovf_networks:
          'nat': '{{ lab_lan1_portgroup }}'
          'hostonly': '{{ lab_lan1_portgroup }}'
          'bridged': '{{ lab_lan1_portgroup }}'
        ovf_properties:
      hosts:
        onefs-1:
        onefs-2:
        onefs-3:

    centos:
      vars:
        vm_memory_mb: 4096
        vm_num_cpus: 2
        vm_disk_gb: 40
        install_xrdp: true
        install_ansible: true
        network_device_type: virtio
      hosts:
        centos7:
          state: force
          ip_address: 192.168.0.171
          distro: "centos"
          version: "7"
        #   extra_commands:
        #     # Install Docker-CE
        #     - "yum install -y epel-release"
        #     - "yum remove -y python-docker-py docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-engine"
        #     - "yum-config-manager --add-repo=https://download.docker.com/linux/centos/docker-ce.repo"
        #     - "yum install -y docker-ce docker-ce-cli containerd.io"
        #     - "systemctl enable docker --now"
        centos8:
          state: force
          ip_address: 192.168.0.181
          distro: "centos"
          version: "8"
          install_xrdp: true
          install_ansible: true # broken in centos8, missing dependancy
        alma8:
          state: force
          ip_address: 192.168.0.182
          distro: "alma"
          version: "8"
          install_xrdp: true
          install_ansible: true
          disks:
            - size_gb: 140
              type: thin
            - size_gb: 200
              type: thin
          networks:
            - name: "{{ lab_lan1_portgroup }}"
              device_type: e1000
            - name: "{{ lab_lan1_portgroup }}"
              device_type: e1000
          serial_ports:
            - type: 'pipe'
              pipe_name: '\\.\pipe\{{lab_name}}_com1'
              endpoint: 'client'
        rocky810:
          state: force
          ip_address: 192.168.0.182
          distro: "rocky"
          version: "8.10"
          install_xrdp: true
          install_ansible: true
          nested_virtualization: true
        #   extra_commands:
        #     # Install Docker-CE
        #     - "dnf install -y epel-release"
        #     - "dnf remove -y python-docker-py docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-engine"
        #     - "dnf remove -y runc podman buildah"
        #     - "dnf config-manager --add-repo=https://download.docker.com/linux/centos/docker-ce.repo"
        #     - "dnf install -y docker-ce docker-ce-cli containerd.io"
        #     - "systemctl enable docker --now"
        rhel8:
          state: force
          ip_address: 192.168.0.184
          distro: "rhel"
          version: "8.8"
          install_xrdp: true
          install_ansible: true
        stream8:
          state: force
          ip_address: 192.168.0.185
          distro: "stream"
          version: "8"
          install_xrdp: true
          install_ansible: true
          nested_virtualization: true
        stream9:
          state: force
          ip_address: 192.168.0.186
          distro: "stream"
          version: "9"
          vm_memory_mb: 4096
          install_xrdp: true
          install_ansible: true
          nested_virtualization: true
        rocky91:
          state: force
          ip_address: 192.168.0.187
          distro: "rocky"
          version: "9.1"
          vm_memory_mb: 4096
          install_xrdp: true
          install_ansible: true
          nested_virtualization: true
        rocky92:
          state: force
          ip_address: 192.168.0.192
          distro: "rocky"
          version: "9.2"
          vm_memory_mb: 4096
          install_xrdp: true
          install_ansible: true
          nested_virtualization: true
        rocky93:
          state: force
          ip_address: 192.168.0.193
          distro: "rocky"
          version: "9.3"
          vm_memory_mb: 4096
          install_xrdp: true
          install_ansible: true
          nested_virtualization: true
        rocky94:
          state: force
          ip_address: 192.168.0.194
          distro: "rocky"
          version: "9.4"
          vm_memory_mb: 4096
          nested_virtualization: true
          ethernet_ports:
            eth0: "{{ lab_lan1_portgroup }}"
            eth1: "{{ lab_lan1_portgroup }}"
            eth2: "{{ lab_lan1_portgroup }}"
          disks:
          - size_gb: 160
            type: thin
          - size_gb: 3072
            type: thin

    esx:
      hosts:
        esx01:
          ip_address: 192.168.0.51
        esx02:
          ip_address: 192.168.0.52
          install_iso: "VMware-VMvisor-Installer-8.0U3-24022510.x86_64.iso"
        esx03:
          ip_address: 192.168.0.53
          install_iso: "VMware-VMvisor-Installer-7.0U3n-21930508.x86_64.iso"
        # esx04:
        #   ip_address: 192.168.0.54
      vars:
          install_iso: "VMware-VMvisor-Installer-9.0.0.0.24755229.x86_64.iso"
          vm_memory_mb: 10240
          vm_num_cpus: 2
          disk_controller: nvme
          vm_disk1_size_gb: 6
          vm_disk2_size_gb: 60
          vm_disk3_size_gb: 80
          create_local_vmfs: 'False'
          enable_ssh: 'True'

    vsims:
      hosts:
        vha-01:
          state: force
          version: "9.16.1"
          ip_address:    192.168.0.141
          cluster_name:    "vha"
          cluster_mgmt_ip: 192.168.0.140
          sys_serial_number: "408236-85-07"
          # add_nodes_by_serial: "408236-85-08"
          bootargs:
            - bootarg.vm.madlabber=true
          extra_commands:
            # - sleep 180 # give nodes time to join
            - node run vha-01 disk assign all
            # - node run vha-02 disk assign all
            - storage aggregate create -aggregate aggr1 -diskcount 8 -node vha-01
            # - storage aggregate create -aggregate aggr2 -diskcount 8 -node vha-02
          #update_package: files/9171RC1_v_image.tgz
          #add_nodes_by_serial: "408236-85-08,408236-85-09,408236-85-10"
          ethernet_ports:
            e0a: '{{ lab_lan2_portgroup }}'
            e0b: '{{ lab_lan2_portgroup }}'
            e0c: '{{ lab_lan1_portgroup }}'
            e0d: '{{ lab_lan1_portgroup }}'
            e0e: '{{ lab_lan1_portgroup }}'
            e0f: '{{ lab_lan1_portgroup }}'
            e0g: '{{ lab_lan2_portgroup }}'
            e0h: '{{ lab_lan2_portgroup }}'

        vha-02:
          state: force
          version: "9.16.1"
          ip_address:    192.168.0.142
          sys_serial_number: "408236-85-08"
          #update_package: files/9171RC1_v_image.tgz
          ethernet_ports:
            e0a: '{{ lab_lan2_portgroup }}'
            e0b: '{{ lab_lan2_portgroup }}'
            e0c: '{{ lab_lan1_portgroup }}'
            e0d: '{{ lab_lan1_portgroup }}'
            e0e: '{{ lab_lan2_portgroup }}'

        vscsi-01:
          state: force
          version: "9.16.1"
          ip_address:    192.168.0.151
          cluster_name:    "vscsi"
          cluster_mgmt_ip: 192.168.0.150
          sys_serial_number: "408236-85-07"
          disk_model: "vscsi"
          shelf0_disk_size: 4096
          shelf0_disk_count: 12
          # shelf1_disk_size: 1024
          # shelf1_disk_count: 9
          # shelf2_disk_size: 1096
          # shelf2_disk_count: 9
          # shelf3_disk_size: 1096
          # shelf3_disk_count: 9
          fake_ssd_disk_size: 4096
          add_nodes_by_serial: "408236-85-08"
          bootargs:
            - bootarg.vm.madlabber=true
          extra_commands:
            - sleep 180 # give nodes time to join
            - node run vha-01 disk assign all
            - node run vha-02 disk assign all
            - storage aggregate create -aggregate aggr1 -diskcount 8 -node vha-01
            - storage aggregate create -aggregate aggr2 -diskcount 8 -node vha-02
          update_package: files/9171RC1_v_image.tgz
        vscsi-02:
          state: force
          ovf_version: "9.16.1"
          ip_address:    192.168.0.142
          sys_serial_number: "408236-85-08"
          update_package: files/9171RC1_v_image.tgz
          disk_model: "vscsi"
          shelf0_disk_size: 4096
          shelf0_disk_count: 12
        demo2-01:
          partner:      "demo2-02"
          cluster_name: "demo"
          ovf_version:  "9.16.1"
          #update_package: files/9171RC1_v_image.tgz
          cluster_mgmt_ip: 192.168.0.160
          ip_address:      192.168.0.161
          partner_ip:      192.168.0.162
          disk_model: "vscsi"
          shelf0_disk_size: 4096
          shelf0_disk_count: 12
          shelf1_disk_size: 4096
          shelf1_disk_count: 12
          fake_ssd_disk_size: 4096
          adp_enabled: "true"
          sys_serial_number: "4082368-50-7"
          partner_serial: "4034389-06-2"
          # extra_commands:
          #   - cluster ha modify -configured true

          